import{_,r as d,o as y,a as z,c as u,b as s,d as C,F as L,e as V,w as f,v as h,f as l,n as N,t as v,g as x}from"./index-D7azGW4m.js";const S={class:"h-dvh w-dvw bg-zinc-800 flex flex-col"},B={class:"bg-zinc-50 flex-1 overflow-y-scroll py-2"},I={key:0,class:"user-message p-2"},M={class:"user-message__user"},U={class:"user-message__text"},$={key:1,class:"system-message text-zinc-800 mx-4 px-2 py-1 font-black text-center"},j={class:"h-30 p-4 flex bg-white"},F={__name:"ChatRoom",props:["username"],emits:["logout"],setup(m,{emit:n}){const r=m,a=n,o=d(""),g=d([]),e=d(null),p=()=>{const i={type:"message",user:r.username,text:o.value};e.value.send(JSON.stringify(i)),o.value=""},b=()=>{e.value=new WebSocket("wss://websocket-chatroom-practice-back.onrender.com"),e.value.onopen=()=>{const i={type:"join",user:r.username};e.value.send(JSON.stringify(i))},e.value.onmessage=i=>{const t=JSON.parse(i.data);g.value.push(t)},e.value.onclose=()=>{}},w=()=>{console.log("hi"),e.value.close(),console.log("close"),a("logout")};return y(()=>{b()}),z(()=>{e.value&&e.value.close()}),(i,t)=>(l(),u("section",S,[s("div",{class:"bg-zinc-900 text-white backdrop-blur-lg w-full p-4 text-lg text-center relative"},[t[2]||(t[2]=C(" 聊天室 ")),s("button",{class:"absolute right-4 cursor-pointer",onClick:w},t[1]||(t[1]=[s("i",{class:"fa-solid fa-right-from-bracket"},null,-1)]))]),s("div",B,[(l(!0),u(L,null,V(g.value,(c,k)=>(l(),u("div",{class:N(["message",[c.user===m.username?"my-message":"others-message"]]),key:k},[c.user?(l(),u("div",I,[s("div",M,v(c.user),1),s("div",U,v(c.text),1)])):(l(),u("div",$,v(c.text),1))],2))),128))]),s("div",j,[f(s("textarea",{"onUpdate:modelValue":t[0]||(t[0]=c=>o.value=c),name:"",id:"",class:"flex-1 bg-white rounded-3xl drop-shadow-lg p-3"},null,512),[[h,o.value]]),s("button",{onClick:p,class:"ml-4 mr-1"},t[3]||(t[3]=[s("i",{class:"fa-solid fa-paper-plane"},null,-1)]))])]))}},J=_(F,[["__scopeId","data-v-c34932d0"]]),O={class:"h-dvh w-dvw bg-zinc-900 flex justify-center items-center"},D={class:"text-white grid grid-rows-3 gap-4 rounded-2xl p-6"},R={__name:"LoginForm",emits:["login"],setup(m,{emit:n}){const r=n,a=d(""),o=()=>{a.value&&r("login",a.value)};return(g,e)=>(l(),u("section",O,[s("div",D,[e[1]||(e[1]=s("div",{class:"text-center flex justify-center items-center text-lg"},"請輸入暱稱",-1)),f(s("input",{"onUpdate:modelValue":e[0]||(e[0]=p=>a.value=p),class:"bg-white rounded-2xl text-2xl text-zinc-900 px-4 py-1",type:"text"},null,512),[[h,a.value]]),s("button",{onClick:o,class:"bg-zinc-600 hover:bg-zinc-500 transition-colors duration-200 rounded-2xl cursor-pointer"}," 登入 ")])]))}},T={__name:"ChatView",setup(m){const n=d(""),r=o=>{n.value=o},a=()=>{console.log("clear?"),n.value=""};return(o,g)=>n.value?(l(),x(J,{key:0,username:n.value,onLogout:a},null,8,["username"])):(l(),x(R,{key:1,onLogin:r}))}},E=_(T,[["__scopeId","data-v-c3895457"]]);export{E as default};
